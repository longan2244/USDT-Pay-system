# USDT TRC20 支付系统配置项说明

本文档详细说明了系统配置文件 `db/settings.json` 中的各项配置参数，帮助您根据实际需求进行系统调整。

## 服务器配置

| 配置项 | 说明 | 推荐值 |
|-------|------|-------|
| `port` | 系统运行的HTTP服务端口 | `9998` |
| `jwtSecret` | JWT认证密钥，用于生成和验证管理员令牌 | 建议修改为强密码 |

## 管理员配置

| 配置项 | 说明 | 推荐值 |
|-------|------|-------|
| `adminKey` | 管理员登录密码 | 建议修改为强密码 |

## Tron网络配置

| 配置项 | 说明 | 推荐值 |
|-------|------|-------|
| `walletAddress` | 收款钱包地址，所有支付将发送到此地址 | 您的TRC20钱包地址 |
| `fullHost` | TRON API服务器地址 | `https://api.trongrid.io` |
| `privateKey` | 钱包私钥（可选，仅在需要自动转账功能时使用） | 留空或填入私钥 |
| `contractAddress` | USDT合约地址 | `TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t` |
| `apiKey` | TRON API密钥，从trongrid.io申请 | 您的API密钥 |

## 交易监控配置

| 配置项 | 说明 | 推荐值 |
|-------|------|-------|
| `pollingTime` | 轮询交易状态的间隔时间（秒） | `30` |
| `expirationTime` | 订单过期时间（分钟） | `16` |
| `requiredConfirmations` | 交易确认所需的区块确认数 | `19` |
| `checkTimeWindow` | 检查交易的时间窗口（分钟），系统将检查此时间范围内的交易 | `60` |

## 订单金额配置

| 配置项 | 说明 | 推荐值 |
|-------|------|-------|
| `randomDecimalMin` | 订单金额随机小数的最小值，用于生成唯一订单金额 | `0.01` |
| `randomDecimalMax` | 订单金额随机小数的最大值，用于生成唯一订单金额 | `0.5` |

> **说明**：系统会在基础商品价格上增加一个随机小数，以生成唯一的订单金额，便于识别不同用户的支付。例如，商品价格为10 USDT，系统可能生成10.23 USDT的实际支付金额。

## 订单限制配置

| 配置项 | 说明 | 推荐值 |
|-------|------|-------|
| `maxPendingOrdersPerDevice` | 每个设备允许的最大待处理订单数 | `2` |
| `orderCreationCooldown` | 订单创建冷却时间（分钟），限制用户在短时间内创建多个订单 | `5` |
| `maxOrdersInCooldownPeriod` | 冷却期内允许创建的最大订单数 | `2` |

## 数据保存配置

| 配置项 | 说明 | 推荐值 |
|-------|------|-------|
| `dataSaveInterval` | 数据自动保存间隔（分钟） | `5` |

## 系统信息

| 配置项 | 说明 |
|-------|------|
| `lastUpdated` | 配置最后更新时间戳，系统自动维护，无需手动修改 |

## 配置修改说明

1. 您可以通过管理员界面修改大部分配置项
2. 修改配置后，系统会自动重新加载配置，无需重启服务
3. 部分敏感配置（如钱包地址、API密钥）修改后，交易监控服务会自动更新

## 安全建议

1. 务必修改默认的JWT密钥和管理员密码
2. 私钥配置非常敏感，建议仅在安全环境中使用
3. 定期备份配置文件和数据文件
4. 使用HTTPS协议保护API通信安全