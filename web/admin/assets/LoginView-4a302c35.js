import{r as y,_ as h,u as w,g as u,q as K,o as _,c as v,i as k,L as S,a as e,m as b,p as V,G as L,t as x,b as N,A as T}from"./index-e339bdcb.js";function D(i){return console.log(i),y({url:"/admin/login",method:"post",data:i})}const I={class:"login-page"},A={class:"login-card"},B={class:"login-form"},U={class:"form-group"},q={key:0,class:"error-message"},C={__name:"LoginView",setup(i){const r=w(),a=u({adminKey:""}),l=u(!1),o=u(""),{showNotification:c}=K(),g=async()=>{var d,s,t,p;if(!a.value.adminKey){o.value="请输入管理员密钥";return}try{l.value=!0,o.value="";const f=(await D({adminKey:a.value.adminKey})).data.token;localStorage.setItem("adminToken",f);const{data:m}=await T();c("success","登录成功","欢迎使用USDT收款系统"),!m.apiKey||!m.walletAddress?(c("warning","系统配置不完整","请先完成钱包地址和API密钥的配置",5e3),localStorage.setItem("redirectToSettings","true"),r.push("/settings").then(()=>{r.go(0)})):r.push("/dashboard")}catch(n){console.error("登录失败:",n),o.value=((s=(d=n.response)==null?void 0:d.data)==null?void 0:s.message)||"管理员密钥错误",c("error","登录失败",((p=(t=n.response)==null?void 0:t.data)==null?void 0:p.message)||"管理员密钥错误")}finally{l.value=!1}};return(d,s)=>(_(),v("div",I,[k(S,{"is-loading":l.value},null,8,["is-loading"]),e("div",A,[s[2]||(s[2]=e("div",{class:"login-header"},[e("i",{class:"ri-currency-line"}),e("h1",null,"USDT收款系统")],-1)),e("div",B,[e("div",U,[s[1]||(s[1]=e("label",null,"管理员登录密码",-1)),b(e("input",{type:"password",autocomplete:"off","onUpdate:modelValue":s[0]||(s[0]=t=>a.value.adminKey=t),class:"form-input",placeholder:"请输入管理员密码",onKeyup:L(g,["enter"])},null,544),[[V,a.value.adminKey,void 0,{trim:!0}]]),o.value?(_(),v("p",q,x(o.value),1)):N("",!0)]),e("div",{class:"form-actions"},[e("button",{class:"btn-primary btn-block",onClick:g},"登录")])])])]))}},E=h(C,[["__scopeId","data-v-d7e63f87"]]);export{E as default};
